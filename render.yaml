services:
  - type: web
    name: thermal-app-gps-backend
    env: docker
    rootDir: backend
    plan: free
    autoDeploy: true
    envVars:
      - key: YOLO_DEVICE
        value: cpu
      - key: CORS_ALLOW_ALL
        value: "true"
      - key: DJI_IRP_PATH
        value: /app/tools/dji-tsdk/utility/bin/linux/release_x64/dji_irp
      - key: LD_LIBRARY_PATH
        value: /app/tools/dji-tsdk/utility/bin/linux/release_x64

  - type: web
    name: thermal-app-gps-frontend
    env: node
    rootDir: frontend
    plan: free
    autoDeploy: true
    buildCommand: npm ci && npm run build
    startCommand: npm run start
    envVars:
      - key: NODE_VERSION
        value: "20.18.0"
      - key: NEXT_PUBLIC_BACKEND_URL
        fromService:
          type: web
          name: thermal-app-gps-backend
          envVarKey: RENDER_EXTERNAL_URL
